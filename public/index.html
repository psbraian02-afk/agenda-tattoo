<!DOCTYPE html> 
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>RichardTattoo | Tatuador profesional</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Inter:wght@200;300;400;600&display=swap" rel="stylesheet">

<style>
:root {
  --gold: #b38e44; 
  --gold-light: #d4af37;
  --bg-white: #ffffff;
  --bg-soft: #faf9f6; 
  --text-dark: #1a1a1a;
  --text-muted: #888888;
  --border: rgba(179, 142, 68, 0.2);
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html { scroll-behavior: smooth; }

body {
  margin: 0;
  padding: 0;
  background-color: var(--bg-soft);
  color: var(--text-dark);
  font-family: 'Inter', sans-serif;
  overflow-x: hidden;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}

/* --- Estilos de la nueva Galería Superior --- */
.featured-gallery {
    width: 100%;
    display: flex;
    gap: 5px;
    padding: 10px;
    margin-bottom: 5px;
}
.featured-photo {
    flex: 1;
    aspect-ratio: 1/1;
    background: #eee;
    border-radius: 8px;
    overflow: hidden;
    border: 1px solid var(--border);
}
.featured-photo img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    cursor: pointer;
    transition: transform 0.3s ease;
}
.featured-photo img:hover {
    transform: scale(1.05);
}
/* ------------------------------------------ */

.tattoo-card p { 
    display: none !important; 
    visibility: hidden !important;
    height: 0;
    margin: 0;
}

::-webkit-scrollbar { width: 5px; }
::-webkit-scrollbar-thumb { background: var(--gold); }

.main-wrapper {
  width: 100%;
  min-height: 100vh;
}

.hero-section {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 10px;
}

.app {
  width: 100%;
  max-width: 500px;
  height: 95vh; 
  min-height: 600px;
  background: var(--bg-white);
  border: 1px solid var(--border);
  border-radius: 15px; 
  box-shadow: 0 20px 50px rgba(0,0,0,0.1);
  position: relative;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.screen {
  position: absolute;
  inset: 0;
  padding: 20px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  gap: 15px;
  opacity: 0;
  transform: translateY(20px);
  pointer-events: none;
  transition: opacity 0.4s ease, transform 0.4s ease;
  background: var(--bg-white); 
  z-index: 1;
  overflow-y: auto;
}

.screen.active {
  opacity: 1;
  transform: translateY(0);
  pointer-events: auto;
  position: relative; 
  z-index: 2;
}

.card-selected {
  border-color: var(--gold) !important;
  background: #fdfaf3 !important;
  box-shadow: 0 5px 15px rgba(179, 142, 68, 0.2) !important;
}
.card-selected img {
  filter: grayscale(0%) !important;
}

.logo-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  margin-bottom: 5px;
}

.logo-circle {
  width: 70px;
  height: 70px;
  border: 2px solid var(--gold);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 15px;
  position: relative;
}

.logo-symbol {
  width: 70%; 
  height: 70%;
  object-fit: contain;
}

h1.brand {
  font-family: 'Cinzel', serif;
  font-size: 22px;
  font-weight: 400;
  color: var(--text-dark);
  margin: 0;
  letter-spacing: 4px;
  text-transform: uppercase;
  text-align: center;
}

.brand-divider {
  display: flex;
  align-items: center;
  gap: 15px;
  width: 100%;
  max-width: 280px;
  margin-top: 5px;
}

.line {
  height: 1px;
  background: linear-gradient(to right, transparent, var(--gold), transparent);
  flex: 1;
}

h2 { 
  font-family: 'Cinzel', serif;
  font-weight: 400; 
  letter-spacing: 4px; 
  text-transform: uppercase; 
  font-size: 18px; 
  color: var(--gold);
  margin-bottom: 10px;
}

button {
  padding: 15px 30px;
  border-radius: 8px;
  border: 1px solid var(--gold);
  background: transparent;
  color: var(--gold);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 2px;
  font-size: 11px;
  cursor: pointer;
  transition: all 0.3s ease;
  width: 100%;
  max-width: 280px;
}

button:hover:not(:disabled) {
  background: var(--gold);
  color: white;
}

button:disabled {
  opacity: 0.4;
  cursor: not-allowed;
  border-color: #ddd;
  color: #aaa;
  background: #f9f9f9;
}

input {
  background: transparent;
  border: none;
  border-bottom: 1px solid #ddd;
  padding: 15px;
  color: var(--text-dark);
  width: 100%;
  max-width: 280px;
  text-align: center;
  font-size: 14px;
  transition: 0.4s;
}

.grid { 
  display: grid; 
  grid-template-columns: repeat(4, 1fr); 
  gap: 8px; 
  width: 100%; 
}

#hoursGrid { 
  display: grid;
  grid-template-columns: repeat(2, 1fr); 
  gap: 10px; 
  width: 100%;
  max-width: 220px; 
}

.tattoo-options, .body-zones {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
  width: 100%;
}

.tattoo-card, .zone-card {
  background: #fff;
  border: 1px solid #f0f0f0;
  border-radius: 10px;
  padding: 10px;
  transition: all 0.3s ease;
  text-align: center;
  cursor: pointer;
}

.tattoo-card img, .zone-card img {
  width: 100%; 
  height: 80px; 
  object-fit: contain; 
  margin-bottom: 8px;
  filter: grayscale(100%); 
  transition: 0.3s;
}

.admin-card {
  background: #fff;
  margin-bottom: 10px;
  padding: 12px;
  border: 1px solid #eee;
  display: flex;
  align-items: center;
  gap: 10px;
}

.admin-img-preview {
    width: 50px; height: 50px;
    object-fit: cover; border: 1px solid var(--gold);
}

.social { display: flex; gap: 20px; margin-top: 10px; }
.social-btn img { width: 22px; filter: grayscale(1) opacity(0.5); transition: 0.3s; }

.map-preview-container {
  width: 100%;
  max-width: 280px;
  height: 100px;
  border: 1px solid var(--gold);
  border-radius: 10px;
  overflow: hidden;
  position: relative;
  cursor: pointer;
}

#lightbox {
  position: fixed; inset: 0; background: rgba(0,0,0,0.9);
  display: none; align-items: center; justify-content: center; z-index: 10000;
}
#lightbox img { max-width: 90%; border: 5px solid white; }

</style>
</head>
<body>

<div id="lightbox" onclick="this.style.display='none'">
  <img id="lightboxImg" src="" loading="lazy">
</div>

<div class="main-wrapper">
  <section class="hero-section">
    <div class="app">

      <div class="screen active" id="home">
        <div class="featured-gallery">
            <div class="featured-photo">
                <img src="foto1.png" alt="Trabajo 1" onerror="this.src='https://via.placeholder.com/300?text=Foto+1'" onclick="expandImage(this.src)">
            </div>
            <div class="featured-photo">
                <img src="foto2.png" alt="Trabajo 2" onerror="this.src='https://via.placeholder.com/300?text=Foto+2'" onclick="expandImage(this.src)">
            </div>
            <div class="featured-photo">
                <img src="foto3.png" alt="Trabajo 3" onerror="this.src='https://via.placeholder.com/300?text=Foto+3'" onclick="expandImage(this.src)">
            </div>
        </div>

        <div class="logo-container">
          <div class="logo-circle">
            <img src="logo.png" alt="Logo" class="logo-symbol" loading="eager" onerror="this.src='https://cdn-icons-png.flaticon.com/512/2111/2111303.png'">
          </div>
          <h1 class="brand">Richard Tattoo</h1>
          <div class="brand-divider">
            <div class="line"></div>
            <p style="letter-spacing: 3px; color: var(--text-muted); font-size: 9px; font-weight: 300; text-transform: uppercase; margin: 0;">Artigas, UY</p>
            <div class="line"></div>
          </div>
        </div>
        
        <p style="letter-spacing: 5px; color: var(--gold); font-size: 11px; font-weight: 400; text-transform: uppercase; margin-top: -5px;">Estudio de Arte Privado</p>
        
        <div style="display:flex; flex-direction:column; gap:10px; width: 260px;">
          <button onclick="tryGoAgenda()" style="background: var(--gold); color: white;">Agendar Cita</button>
          <button id="btnProfile" style="display:none; font-size:9px;" onclick="go('login')">Mi Perfil / Editar Datos</button>
          <button style="border:none; font-size:10px; opacity:0.5; letter-spacing:2px; cursor:pointer;" onclick="promptAdmin()">Acceso Artista</button>
        </div>
        
        <div class="social">
          <a class="social-btn" href="https://www.facebook.com/richardtattoo/?locale=es_LA" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/733/733547.png" alt="FB"></a>
          <a class="social-btn" href="https://www.instagram.com/richardtattooartigas/" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/1384/1384063.png" alt="IG"></a>
          <a class="social-btn" href="https://wa.me/59892528388" target="_blank"><img src="https://cdn-icons-png.flaticon.com/512/733/733585.png" alt="WA"></a>
        </div>
        
        <div class="map-preview-container" onclick="openMap()">
          <iframe 
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3412.5!2d-56.466!3d-30.4!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zMzDCsDI0JzAwLjAiUyA1NiwyNyc1Ny42Ilc!5e0!3m2!1ses!2suy!4v1625000000000!5m2!1ses!2suy" 
            width="100%" height="100%" style="border:0; pointer-events:none;" allowfullscreen="" loading="lazy"></iframe>
        </div>
      </div>

      <div class="screen" id="login">
        <h2>Mis Datos</h2>
        <input id="nameInput" type="text" placeholder="NOMBRE">
        <input id="surnameInput" type="text" placeholder="APELLIDO">
        <input id="emailInput" type="email" placeholder="CORREO (OPCIONAL)">
        <input id="phoneInput" type="tel" placeholder="TELÉFONO (8 NÚMEROS)" maxlength="8">
        <button onclick="login()" style="margin-top:20px; background: var(--gold); color: white;">Continuar</button>
        <button onclick="go('home')" style="border:none; font-size:11px">Cancelar</button>
      </div>

      <div class="screen" id="month">
        <h2>Calendario</h2>
        <div class="grid" id="months" style="grid-template-columns: 1fr 1fr;"></div>
        <button onclick="go('home')" style="border:none; font-size:11px">Atrás</button>
      </div>

      <div class="screen" id="day">
        <h2>Seleccionar Día</h2>
        <div class="grid" id="days" style="grid-template-columns: repeat(5, 1fr);"></div>
        <button onclick="go('month')" style="border:none; font-size:11px">Atrás</button>
      </div>

      <div class="screen" id="tattooDetails">
        <h2>Proyecto</h2>
        <div class="tattoo-options" id="tattooOptions"></div>
        <button id="nextTattooBtn" disabled onclick="confirmTattooSelection()" style="background: var(--gold); color: white;">Siguiente</button>
        <button onclick="go('day')" style="border:none; font-size:11px">Atrás</button>
      </div>

      <div class="screen" id="zoneSelection">
        <h2>Zona del Cuerpo</h2>
        <div class="body-zones" id="zoneOptions"></div>
        <button id="nextZoneBtn" disabled onclick="confirmZoneSelection()" style="background: var(--gold); color: white;">Siguiente</button>
        <button onclick="go('tattooDetails')" style="border:none; font-size:11px">Atrás</button>
      </div>

      <div class="screen" id="hourSelection">
        <h2>Horario</h2>
        <div id="hoursGrid"></div>
        <button onclick="goBackFromHours()" style="border:none; font-size:11px">Atrás</button>
      </div>

      <div class="screen" id="imageUploadScreen">
        <h2>Referencia</h2>
        <input type="file" id="userTattooImage" accept="image/*" style="display:none">
        <button onclick="document.getElementById('userTattooImage').click()">Seleccionar Imagen</button>
        <img id="userTattooPreview" style="display:none; width: 100px; border-radius: 10px;">
        <p id="userTattooInfo" style="font-size:11px; color: var(--gold);"></p>
        <button id="confirmBtn" onclick="confirmBooking()" style="background: var(--gold); color: white;">Confirmar Reserva</button>
        <button onclick="go('hourSelection')" style="border:none; font-size:11px">Atrás</button>
      </div>

      <div class="screen" id="done">
        <h1 class="brand">Confirmado</h1>
        <p style="text-align:center; font-size:13px;">Cita registrada con éxito.</p>
        <button onclick="resetBookingFlow()">Finalizar</button>
      </div>

      <div class="screen" id="admin">
        <h2>Agenda Artista</h2>
        <div id="adminList" style="width:100%;"></div>
        <button onclick="logoutAdminSession()" style="color:red; border-color:red;">Cerrar Sesión</button>
        <button onclick="go('home')" style="border:none;">Cerrar</button>
      </div>

    </div>
  </section>
</div>

<script>
// Lógica de navegación y reserva (basada en el código anterior)
const SERVER_URL="/api/bookings";
const DURATIONS={ "mini":1, "small":1, "medium":1.5, "large":2.25, "muy-grande":3.6, "manga-brazo":4.5, "espalda-completa":5 };

let selectedMonth, selectedDay, selectedTattoo, selectedHour, selectedZone;
let bookings = [];
const user = { 
    phone: localStorage.getItem("whatsapp"), 
    name: localStorage.getItem("userName"),
    surname: localStorage.getItem("userSurname")
};

function go(id) {
    document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
    document.getElementById(id).classList.add("active");
}

function expandImage(src) {
    const lb = document.getElementById("lightbox");
    const lbImg = document.getElementById("lightboxImg");
    lbImg.src = src;
    lb.style.display = 'flex';
}

function tryGoAgenda(){ 
    if(user.phone && user.name) go("month");
    else go("login");
}

function login(){ 
    const n = document.getElementById("nameInput").value.trim();
    const s = document.getElementById("surnameInput").value.trim();
    const p = document.getElementById("phoneInput").value.trim();
    if(!n || !s || p.length < 8) return alert("Completa los datos correctamente.");
    localStorage.setItem("userName", n);
    localStorage.setItem("userSurname", s);
    localStorage.setItem("whatsapp", p);
    user.name = n; user.phone = p;
    go("month"); 
}

// Inicialización de meses
const MONTHS=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];
const monthsEl=document.getElementById("months");
MONTHS.forEach((m,i)=>{
    const b=document.createElement("button");
    b.textContent=m;
    b.onclick=()=>{ selectedMonth=i; renderDays(); go('day'); };
    monthsEl.appendChild(b);
});

function renderDays(){
    const daysEl=document.getElementById("days");
    daysEl.innerHTML="";
    for(let d=1; d<=30; d++){
        const b=document.createElement("button");
        b.textContent=d;
        b.onclick=()=>{ selectedDay=d; renderTattooOptions(); go("tattooDetails"); };
        daysEl.appendChild(b);
    }
}

const TATTOO_SIZES=[ 
  { id:"mini", label:"Mini (5cm)", img:"muy-pequeño.png" }, 
  { id:"small", label:"Pequeño (15cm)", img:"pequeño.png" }, 
  { id:"medium", label:"Mediano (25cm)", img:"mediano.png" }, 
  { id:"large", label:"Grande (35cm)", img:"grande.png" }
];

function renderTattooOptions(){
    const container=document.getElementById("tattooOptions"); container.innerHTML="";
    TATTOO_SIZES.forEach(t=>{
        const card=document.createElement("div"); card.className="tattoo-card";
        card.innerHTML=`<img src="${t.img}" onerror="this.src='https://via.placeholder.com/100'"><div>${t.label}</div>`;
        card.onclick=()=>{
            document.querySelectorAll(".tattoo-card").forEach(c => c.classList.remove("card-selected"));
            card.classList.add("card-selected");
            selectedTattoo=t;
            document.getElementById("nextTattooBtn").disabled=false;
        };
        container.appendChild(card);
    });
}

function confirmTattooSelection(){ renderZones(); go("zoneSelection"); }

function renderZones(){
    const container=document.getElementById("zoneOptions"); container.innerHTML="";
    ["Brazo", "Pierna", "Espalda", "Pecho"].forEach(z=>{
        const card=document.createElement("div"); card.className="zone-card";
        card.innerHTML=`<div style="padding:20px">${z}</div>`;
        card.onclick=()=>{
            selectedZone=z;
            renderHours();
            go("hourSelection");
        };
        container.appendChild(card);
    });
}

function renderHours(){
    const grid=document.getElementById("hoursGrid"); grid.innerHTML="";
    [9,10,11,14,15,16,17,18].forEach(h=>{
        const b=document.createElement("button"); b.textContent=h+":00";
        b.onclick=()=>{ selectedHour=h; go("imageUploadScreen"); };
        grid.appendChild(b);
    });
}

async function confirmBooking(){
    go("done");
}

function resetBookingFlow(){ location.reload(); }

function openMap(){ window.open("https://goo.gl/maps/xyz", "_blank"); }

function promptAdmin(){
    const pass=prompt("Contraseña:");
    if(pass==="richard123") go("admin");
}

function logoutAdminSession(){ go("home"); }
</script>
</body>
</html>